<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Teacher Activity Explorer</title>
<style>
  body { font-family: Arial, sans-serif; margin: 20px; background: #f9f9f9; }
  h1 { text-align: center; }
  .search-section, .tags-section, .buttons { margin-bottom: 20px; }
  .tags-section { display: flex; flex-wrap: wrap; gap: 5px; margin-bottom: 10px; }
  .tags-section h2 { width: 100%; margin-bottom: 5px; }
  .tags-section button { margin: 3px; padding: 5px 10px; border: 1px solid #888; border-radius: 4px; background: #fff; cursor: pointer; }
  .tags-section button.active { background-color: #4a90e2; color: white; }
  .buttons { text-align: center; }
  .buttons button { padding: 8px 16px; margin: 0 5px; border-radius: 4px; border: 1px solid #888; background-color: #eee; cursor: pointer; }
  .activities { display: flex; flex-wrap: wrap; gap: 10px; justify-content: space-between; }
  .activity { border: 1px solid #ccc; padding: 10px; width: 30%; box-sizing: border-box; border-radius: 4px; }
  .activity h3 { margin-top: 0; }
  .tags-caption { font-size: 0.9em; color: #888; margin-top: 6px; }
</style>
</head>
<body>

<h1>Teacher Activity Explorer</h1>

<!-- Search Bar -->
<div class="search-section">
  <input type="text" id="searchBox" placeholder="Search by activity name">
  <button onclick="searchActivities()">Search</button>
</div>

<!-- Tag Buttons -->
<div class="tags-section" id="tagButtons"></div>

<!-- Go Button -->
<div class="buttons">
  <button onclick="filterByTags()">Go</button>
</div>

<!-- Activity Windows -->
<div class="activities" id="activityContainer">
  <div class="activity"><h3>Activity 1</h3><p>Description...</p></div>
  <div class="activity"><h3>Activity 2</h3><p>Description...</p></div>
  <div class="activity"><h3>Activity 3</h3><p>Description...</p></div>
  <div class="activity"><h3>Activity 4</h3><p>Description...</p></div>
  <div class="activity"><h3>Activity 5</h3><p>Description...</p></div>
  <div class="activity"><h3>Activity 6</h3><p>Description...</p></div>
</div>

<script>
let activities = [];
let filteredActivities = [];
let currentTags = [];

// Tag groups
const tagGroups = {
  "Type": ["PRE-ASSESSMENT","INTRODUCE","READ","ANALYZE","REVIEW","EVALUATE"],
  "Genre": ["LONG TEXT","SHORT TEXT","POETRY","VISUAL ART","VOCABULARY"],
  "Mode": ["WRITING (short)","WRITING (long)","WRITING (creative)","DISCUSSION","VISUAL ART"],
  "Misc": ["GAMES","ICEBREAKERS","FORMING GROUPS","ON YOUR FEET"]
};

// Layer colors
const layerColors = {
  "PRE-ASSESSMENT": "#d6eaf8",
  "INTRODUCE": "#fdebd0",
  "READ": "#d5f5e3",
  "ANALYZE": "#f9e79f",
  "REVIEW": "#f5cba7",
  "EVALUATE": "#d2b4de"
  "GAMES": "#d6eaf9",
  "ON YOUR FEET": "#fdebd1",
  "VISUAL ART": "#d5f5e4",
  "FORMING GROUOPS": "#f9e79g",
  "WRITING (short)": "#f5cba8",
  "WRITING (creative)": "#d2b4de",
  "DISCUSSION": "#d2b4de",
  "FORMATIVE": "#f0b3ff",      // add any missing Stage tags
  "SUMMATIVE": "#c6f5d0"
};

// Create tag buttons
const tagContainer = document.getElementById("tagButtons");
for(const group in tagGroups){
  const heading = document.createElement("h2");
  heading.innerText = group;
  tagContainer.appendChild(heading);
  tagGroups[group].forEach(tag => {
    const btn = document.createElement("button");
    btn.innerText = tag;
    btn.onclick = () => {
      btn.classList.toggle("active");
      currentTags = Array.from(document.querySelectorAll(".tags-section button.active")).map(b => b.innerText);
    };
    tagContainer.appendChild(btn);
  });
}

// Load activities JSON
fetch('activities.json')
  .then(res => res.json())
  .then(data => {
    activities = data;
    filteredActivities = [...activities];
    pickRandomActivities();
  })
  .catch(err => console.error("Error loading activities:", err));

// Pick 6 random activities
function pickRandomActivities() {
  const copy = [...filteredActivities];
  const result = [];
  while(result.length < 6 && copy.length > 0){
    const index = Math.floor(Math.random() * copy.length);
    result.push(copy.splice(index,1)[0]);
  }
  renderActivities(result);
}

// Render activities
function renderActivities(list) {
  const container = document.getElementById("activityContainer");
  const windows = container.querySelectorAll(".activity");
  windows.forEach((win, i) => {
    if(list[i]) {
      win.querySelector("h3").innerText = list[i]["Activity Name"];
      win.querySelector("p").innerText = list[i]["Description"];
      const allTags = [list[i]["Stage (Layer 1)"], list[i]["Genre/Production (Layer 2/3)"], list[i]["Miscellaneous Tags"]].filter(Boolean).join(", ");
      let caption = win.querySelector(".tags-caption");
      if(!caption){
        caption = document.createElement("div");
        caption.className = "tags-caption";
        win.appendChild(caption);
      }
      caption.innerText = allTags;
      const primaryTag = list[i]["Stage (Layer 1)"].split(" / ")[0];
      win.style.backgroundColor = layerColors[primaryTag] || "#fff";
    } else {
      win.querySelector("h3").innerText = "No Activity";
      win.querySelector("p").innerText = "";
      let caption = win.querySelector(".tags-caption");
      if(caption) caption.innerText = "";
      win.style.backgroundColor = "#fff";
    }
  });
}

// Search by name
function searchActivities() {
  const query = document.getElementById("searchBox").value.toLowerCase();
  filteredActivities = activities.filter(a => a["Activity Name"].toLowerCase().includes(query));
  pickRandomActivities();
}

// Filter by selected tags (AND logic)
function filterByTags() {
  if(currentTags.length === 0) {
    filteredActivities = [...activities];
  } else {
    filteredActivities = activities.filter(a => {
      const allActivityTags = [
        a["Stage (Layer 1)"],
        a["Genre/Production (Layer 2/3)"],
        a["Miscellaneous Tags"]
      ].join(" / ").toLowerCase();
      return currentTags.every(tag => allActivityTags.includes(tag.toLowerCase()));
    });
  }
  pickRandomActivities();
}
</script>

</body>
</html>


